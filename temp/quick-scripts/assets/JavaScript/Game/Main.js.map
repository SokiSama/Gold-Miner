{"version":3,"sources":["Main.js"],"names":["cc","Class","extends","Component","properties","speed","default","displayName","rotateSpeed","HookRange","Prefabs","type","Prefab","InitTime","CollisionAudio","AudioClip","AddScroeAudio","onLoad","init","director","preloadScene","Miner","find","MinerAnimation","getComponent","Animation","Hook","HookHeight","height","HookState","Score","Label","TargetScore","Time","Checkpoint","itemArea","manager","getCollisionManager","enabled","forEach","item","_name","emitHook","ReloadBtn","PauseBtn","Mask","GameOverBtn","on","Node","EventType","TOUCH_END","CloseMask","bind","Next","emitHookBtn","Reload","ShowMask","ResetInfo","StartTime","SetLevel","CreateTargetScor","CreateItem","HookRoTate","rotation","Math","abs","children","childrenCount","Handle","StopHookMove","PullBackHook","play","SetSpeed","other","ItemAttr","node","name","victory","string","timer","setInterval","clearInterval","GameOver","level","sys","localStorage","getItem","setItem","targetScoreBase","inc","targetScore","scoreBase","Range","parseInt","random","itemArr","sortItems","newItemArr","CreateCalc","instantiate","XY","randomXY","parent","setPosition","groundY","y","randX","width","randY","v2","newArr","key","push","sort","a","b","score","s","createRandm","g","d","list","num","createItemArr","CreateItemType","a1","a2","b1","b2","arr","i","min","max","str","n","m","stop","items","AddScore","RemoveItem","destroy","scoreCon","audioEngine","_GamePauseAminationCallBack","game","pause","finished","callFunc","action","sequence","scaleTo","easing","easeBounceOut","runAction","resume","loadScene","cur","match","ExitGame","update","dt"],"mappings":"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","file":"Main.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\JavaScript\\Game","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\n// Learn Attribute:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\n\n//引入 得分等配置 太长 所以换个文件写\nimport ItemAttr from './Config';\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        //钩子速度\n        speed : {\n            default : 3,\n            displayName : '钩子速度'\n        },\n        //钩子旋转速度\n        rotateSpeed : {\n            default : 1,\n            displayName : '钩子旋转速度'\n        },\n        //钩子范围\n        HookRange : {\n            default : 70,\n            displayName : '钩子旋转角度范围'\n        },\n        //所有的prefab 这种方式是同步的 代码比较好写 就是难拖\n        Prefabs : {\n            default : [],\n            type : cc.Prefab\n        },\n        InitTime : {\n            default : 10,\n        },\n        //钩子触碰到物品的声音\n        CollisionAudio:{\n            default:null,\n            type:cc.AudioClip\n        },\n        //加分的声音\n        AddScroeAudio:{\n            default:null,\n            type:cc.AudioClip\n        },\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        /**\n         * 初始化\n         */\n        this.init();\n\n        //加载首页资源\n        cc.director.preloadScene('Index');\n    },\n\n    /**\n     * @description 初始化 各种需要的比变量\n     */\n    init(){\n        //钩子矿工\n        this.Miner = cc.find('Canvas/Header/Miner');\n        //矿工动画 \n        this.MinerAnimation = this.Miner.getComponent(cc.Animation);\n        //获取钩子\n        this.Hook = cc.find('Canvas/Header/Miner/Hook');\n        //获取钩子初始长度\n        this.HookHeight = this.Hook.height;\n        //放下钩子开关 0 停止 1 发射 2拉回\n        this.HookState = 0;\n        //得分累计\n        this.Score = cc.find('Canvas/Header/Info/ScoreAndTarget/Score').getComponent(cc.Label);\n        //通关目标分数\n        this.TargetScore = cc.find('Canvas/Header/Info/ScoreAndTarget/Target').getComponent(cc.Label);\n        //倒计时\n        this.Time = cc.find('Canvas/Header/Info/CheckpointAndTime/Time').getComponent(cc.Label);\n        //关卡数\n        this.Checkpoint = cc.find('Canvas/Header/Info/CheckpointAndTime/Checkpoint').getComponent(cc.Label);\n        //物品区域\n        this.itemArea = cc.find('Canvas/ItemArea');\n        //开启碰撞\n        this.manager = cc.director.getCollisionManager();\n        this.manager.enabled = true;\n        // this.manager.enabledDebugDraw = true;\n        // manager.enabledDrawBoundingBox = true;\n\n        //重组prefab数组 方便查询\n        this.Prefab = {};\n        this.Prefabs.forEach(item => {\n            this.Prefab[item._name] = item;\n        });\n\n        //发射钩子按钮\n        let emitHook = cc.find('Canvas/emitHookBtn');\n        //重玩本关按钮\n        let ReloadBtn = cc.find('Canvas/Mask/ReloadBtn');\n        //暂停按钮\n        let PauseBtn = cc.find('Canvas/Pause');\n        //弹出框\n        this.Mask = cc.find('Canvas/Mask');\n        //游戏结束按钮 包括过关/结束游戏\n        this.GameOverBtn = cc.find('Canvas/Mask/GameOverBtn');\n\n        this.Mask.on(cc.Node.EventType.TOUCH_END,this.CloseMask.bind(this));\n\n        this.GameOverBtn.on(cc.Node.EventType.TOUCH_END,this.Next.bind(this));\n\n        emitHook.on(cc.Node.EventType.TOUCH_END,this.emitHookBtn.bind(this));\n\n        ReloadBtn.on(cc.Node.EventType.TOUCH_END,this.Reload.bind(this));\n\n        PauseBtn.on(cc.Node.EventType.TOUCH_END,this.ShowMask.bind(this));\n\n        this.ResetInfo();\n        this.StartTime();\n        this.SetLevel();\n        this.CreateTargetScor();\n        this.CreateItem();\n    },\n\n    /**\n     * @description 钩子旋转\n     */\n    HookRoTate(){\n        if(this.HookState)return;\n\n        //限制范围 只能在 70 与 -70 之间\n        if(this.Hook.rotation >= 70){\n            this.rotateSpeed = -this.rotateSpeed;\n        }else if(this.Hook.rotation <= -70){\n            this.rotateSpeed = Math.abs(this.rotateSpeed);\n        };\n\n        this.Hook.rotation += this.rotateSpeed;\n    },\n\n    /**\n     * @description 发射钩子按钮事件\n     */\n    emitHookBtn(){\n        //TODO 停止钩子旋转\n        //打开/关闭 钩子开关 没有拉回之前 当前position ！= 初始位置时 不允许操作\n        if(this.HookState)return;\n\n        this.HookState = 1;\n    },\n\n    /**\n     * @description 发射钩子\n     */\n    emitHook(){\n        switch(this.HookState){\n            case 1:\n                this.Hook.height += this.speed;\n                break;\n            case 2:\n                if(this.Hook.height <= this.HookHeight){\n\n                    //检测是否拉回物品\n                    if(this.Hook.children[1].childrenCount){\n                        this.Handle(this.Hook.children[1].children);\n                    };\n\n                    this.StopHookMove();\n                }else{\n                    this.Hook.height -= this.speed;\n                };\n                break;\n        };\n    },\n\n    /**\n     * @description 拉回钩子\n     */\n    PullBackHook(){\n\n        //播放拉回钩子动画\n        this.MinerAnimation.play('PullRope');\n        this.HookState = 2;\n    },\n\n    /**\n     * 设置钩子拉回的速度\n     */\n    SetSpeed(other){\n        ItemAttr[other.node.name] = ItemAttr[other.node.name] || {};\n        this.speed = ItemAttr[other.node.name].speed || 3;\n    },\n\n    /**\n     * 重置所有分数信息\n     */\n    ResetInfo(){\n        //this.victory 游戏胜利失败状态 0 = 游戏中 1 = 成功 2 = 失败\n        this.victory = \n        this.Score.string = \n        this.Time.string = \n        this.Checkpoint.string = \n        this.TargetScore.string = 0;\n    },\n\n    /**\n     * 启动倒计时\n     */\n    StartTime(){\n        this.Time.string = this.InitTime;\n        this.timer = setInterval(() => {\n            this.InitTime--;\n            this.Time.string = this.InitTime;\n            if(this.InitTime <= 0){\n                clearInterval(this.timer);\n                this.GameOver();\n            };\n        }, 1000);\n    },\n\n    /**\n     * 设置关卡数\n     */\n    SetLevel(){\n        let level = cc.sys.localStorage.getItem('level');\n        if(!level){\n            cc.sys.localStorage.setItem('level',1);\n        };\n\n        this.Checkpoint.string = `第${cc.sys.localStorage.getItem('level')}关`;\n    },\n\n    /**\n     * 确定过关目标分数\n     * 目标分数根据关卡关数确定 难度累加率为\n     *  基数 1000\n     *  每关递增500分\n     * \n     * 最大 5000分\n     */\n    CreateTargetScor(){\n        let level = cc.sys.localStorage.getItem('level') - 1;\n        let targetScoreBase = 1000;\n        let inc = 500;\n        let targetScore = targetScoreBase + inc * level;\n        this.TargetScore.string = targetScore > 5000?5000:targetScore;\n    },\n\n    /**\n     * 生成物品 需要根据目标分来生成 生成的所有物品总分必须比目标过关分数高20%\n     * 生成的物品数量在 10-30\n     */\n    CreateItem(){\n        let scoreBase = this.TargetScore.string + this.TargetScore.string * 0.2;\n        let Range = parseInt(Math.random() * 20 + 10);\n        //先从分数小的 加起来\n        // 如果数量 超过范围限制的数量则删除1个添加一个大分数更大一点的 如果还超出范围 删除两个小的..\n\n        //排序，将物品按分数排序\n        let itemArr = this.sortItems();\n        \n        let newItemArr = this.CreateCalc(itemArr);\n        //生成相应的Prfab\n        newItemArr.forEach(item => {\n            let node = cc.instantiate(this.Prefab[item._name]);\n            let XY = this.randomXY();\n            node.parent = this.itemArea;\n            node.setPosition(XY);\n        });\n    },\n\n    /**\n     * 随机坐标\n     */\n    randomXY(){\n        //x = 屏幕宽度 / 2 * 随机数\n        //y = 地平面位置 + 随机数cc.random0To1() +高度范围（可以说是Y的最小点）\n        //地平面位置 = 地面y + 地面 高度 / 2\n        // - 30是因为物品锚点在中间位置 设置坐标到范围定点的时候 会有部分超出\n        let groundY = this.itemArea.y + this.itemArea.height / 2;\n        let randX = (this.itemArea.width - 30) / 2 * (Math.random() - 0.5) * 2;\n        let randY = (this.itemArea.height- 30) / 2 * (Math.random() - 0.5) * 2;\n        return cc.v2(randX,randY);\n    },\n\n    /**\n     * 排序物品\n     */\n    sortItems(){\n        \n        let newArr = [];\n\n        for(let key in ItemAttr){\n            ItemAttr[key].name = key;\n            newArr.push(ItemAttr[key]);\n        };\n\n        newArr.sort(function(a,b){\n            return a.score > b.score?1:-1;\n        });\n\n        return newArr;\n    },\n    \n    /**\n     * 生成所需的物品清单 每关递增一个钻石 保证最小分数下够分过关\n     */\n    CreateCalc(){\n        //石头2-4个  14 -25\n        let s = this.createRandm(2,4);\n        //黄金10-15个 500 500\n        let g = this.createRandm(10,15);\n        //骨头1-3个\n        let b = this.createRandm(1,3);\n        //钻石1-3个\n        let d = this.createRandm(1,3);\n\n        let list = [\n            {name : 's',num : s},\n            {name : 'g',num : g},\n            {name : 'b',num : b},\n            {name : 'd',num : d}\n        ];\n\n        let createItemArr = [];\n\n        list.forEach(item => {\n\n            switch(item.name){\n                case 's':\n                //TODO\n                    createItemArr = [...createItemArr,...this.CreateItemType('Stone-',0,1,0,3,s)];\n                    break;\n                case 'g':\n                    createItemArr = [...createItemArr,...this.CreateItemType('Gold-',0,1,0,3,g)];\n                    break;\n                case 'b':\n                    createItemArr = [...createItemArr,...this.CreateItemType('Bone-',0,3,0,0,b)];\n                    break;\n                case 'd':\n                    createItemArr = [...createItemArr,...this.CreateItemType('Drill',0,0,0,0,d)];\n                    break;\n            };\n        });\n        //每关累加1个钻石\n        let level = cc.sys.localStorage.getItem('level') - 1;\n\n        createItemArr = [...createItemArr,...this.CreateItemType('Drill',0,0,0,0,level)];\n\n        return createItemArr;\n    },\n    /**\n     * 分类创建物品\n     */\n    CreateItemType(name,a1,a2,b1,b2,num){\n        let arr = [];\n        for(let i=0;i<num;i++){\n            //拼接name\n            let min = this.createRandm(a1,a2);\n            let max = this.createRandm(b1,b2);\n            let str = '';\n            if(name == 'Bone-'){\n                str = name + min;\n            }else if(name == 'Drill'){\n                str = name;\n            }else{\n                str = name + min + '-' + max;\n            };\n            arr.push(this.Prefab[str]);\n        };\n        return arr;\n    },\n\n    /**\n     * 生成n-m随机数\n     */\n    createRandm(n,m){\n        m += 1;\n        let a = m - n;\n        let num = Math.random()*a + n;\n        return parseInt(num);\n    },\n\n    /**\n     * @description 关闭绳子状态\n     */\n    StopHookMove(){\n        this.HookState = 0;\n        this.Hook.height = this.HookHeight;\n        //停止播放拉回动画\n        this.MinerAnimation.stop('PullRope');\n        //重置发射钩子速度\n        this.speed = 3;\n    },\n\n    /**\n     * @description 处理拉回的物品，删除物品以及添加得分\n     */\n    Handle(items){\n        this.AddScore(items);\n        this.RemoveItem(items);\n    },\n\n    /**\n     * @description 删除物品\n     */\n    RemoveItem(items){\n        items.forEach(item => {\n            item.destroy();\n        });\n    },\n    /**\n     * @description 添加得分\n     */\n    AddScore(items){\n        if(!items[0])return;\n        let scoreCon = ItemAttr[items[0].name] || {};\n        this.Score.string = parseInt(this.Score.string) + (scoreCon.score || 0);\n        //播放得分音效\n        cc.audioEngine.play(this.AddScroeAudio);\n    },\n\n    /**\n     * 暂停游戏\n     */\n    _GamePauseAminationCallBack(){\n        cc.game.pause();\n    },\n\n    /**\n     * 显示Mask\n     */\n    ShowMask(){\n        //显示弹出框\n        let finished = cc.callFunc(this._GamePauseAminationCallBack,this);\n        let action =  cc.sequence(cc.scaleTo(0.3,1,1),finished);\n        let str = '';\n        action.easing(cc.easeBounceOut(0.3));\n        //修改显示的文字\n        if(this.victory == 1){\n            str = '下一关';\n        }else if(this.victory == 2){\n            str = '退出游戏';\n        }else{\n            str = '继续游戏';\n        };\n        this.GameOverBtn.children[0].getComponent(cc.Label).string = str;\n\n        this.Mask.runAction(action);\n    },\n\n    /**\n     * 恢复游戏，关闭弹出框\n     * 如果是游戏通关原因而打开的弹出框不予理睬\n     */\n    CloseMask(){\n        if(this.victory)return;\n        let action = cc.scaleTo(0.2,0,0);\n        cc.game.resume();\n        this.Mask.runAction(action);\n    },\n\n    /**\n     * 重玩本关\n     */\n    Reload(){\n        cc.game.resume();\n        //停止倒计时\n        this.timer&&clearInterval(this.timer);\n        //重载场景\n        cc.director.loadScene('Game');\n    },\n\n    /**\n     * 继续下一关\n     */\n    Next(){\n        \n        switch(this.victory){\n            case 0:\n                //继续游戏\n                this.CloseMask();\n                break;\n            case 1:\n                //胜利\n                let cur = this.Checkpoint.string.match(/\\d+/)[0];\n                cc.sys.localStorage.setItem('level',parseInt(cur)+1);\n                this.Reload();\n                break;\n            case 2:\n                //退出游戏\n                this.ExitGame();\n            break;\n        };\n    },\n\n    /**\n     * 退出游戏 返回上一个场景\n     */\n    ExitGame(){\n        cc.game.resume();\n        cc.director.loadScene('Index');\n    },\n\n    /**\n     * 游戏结束\n     * 胜利或失败都视为游戏结束\n     */\n    GameOver(){\n        //判断用户得分是否超过目标分\n        let s = 0;\n\n        if(this.Score.string >= this.TargetScore.string){\n            s = 1;\n        }else{\n            //游戏失败\n            s = 2;\n        };\n        this.victory = s;\n        this.ShowMask();\n    },\n\n    // start () {\n\n    // },\n\n    update (dt) {\n        this.emitHook();\n        this.HookRoTate();\n    },\n});\n"]}